<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>27sun ‚Äì Video editor & photographer</title>
<link href="https://fonts.googleapis.com/css2?family=UnifrakturCook:wght@700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
/* ... (p≈Øvodn√≠ styly zachov√°ny) ... */
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family: Inter, sans-serif; background: #0a0a0a; color: #fff; }

/* OPRAVEN√ù SLOT MACHINE STYL */
.game-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center; z-index: 9999; backdrop-filter: blur(10px); }
.game-content { background: #111; border: 1px solid #ff7a18; padding: 30px; border-radius: 25px; width: 90%; max-width: 400px; text-align: center; }

.slot-container { display: flex; justify-content: center; gap: 10px; margin: 25px 0; height: 120px; overflow: hidden; }
.reel-window { 
    width: 80px; height: 120px; background: #000; border: 2px solid #222; 
    border-radius: 12px; position: relative; overflow: hidden;
}
.reel-strip {
    position: absolute; width: 100%; left: 0; top: 0;
    display: flex; flex-direction: column;
    transition: transform 3s cubic-bezier(0.15, 0, 0.15, 1);
}
.slot-icon { 
    height: 120px; min-height: 120px; display: flex; 
    align-items: center; justify-content: center; font-size: 40px; 
}

.promo-wrap { background: #1a1a1a; border: 1px dashed #ff7a18; padding: 15px; border-radius: 12px; margin-top: 15px; display: flex; justify-content: space-between; align-items: center; }
#promo-code { font-family: monospace; color: #ff7a18; font-weight: bold; font-size: 14px; }
.btn { background: #ff7a18; color: #000; border: none; padding: 12px 25px; border-radius: 50px; cursor: pointer; font-weight: bold; margin-top: 20px; transition: 0.3s; }
.btn:disabled { background: #444; cursor: not-allowed; }

/* SEKCE PRO TEBE NA OVƒö≈òEN√ç */
.admin-verify { margin-top: 50px; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 15px; border: 1px solid #333; text-align: center; }
</style>
</head>
<body>

<section style="text-align: center; padding-top: 100px;">
    <h2>Z√≠skej slevu na projekt</h2>
    <button class="btn" onclick="openGame()">üé∞ OTEV≈ò√çT AUTOMAT</button>
</section>

<div id="game-modal" class="game-overlay">
  <div class="game-content">
    <div id="game-main-screen">
      <h2 style="color:#ff7a18">27sun Slots</h2>
      <p id="attempts-left" style="font-size: 12px; margin: 10px 0;">Pokusy: 5/5</p>
      
      <div class="slot-container">
        <div class="reel-window"><div id="reel1" class="reel-strip"></div></div>
        <div class="reel-window"><div id="reel2" class="reel-strip"></div></div>
        <div class="reel-window"><div id="reel3" class="reel-strip"></div></div>
      </div>

      <button id="spin-btn" class="btn" onclick="spinSlots()">ROZTOƒåIT</button>
      <button onclick="closeGame()" style="display:block; margin: 15px auto; background:none; border:none; color:#666; cursor:pointer;">Zav≈ô√≠t</button>
    </div>

    <div id="game-result-screen" style="display:none">
      <h2 style="color:#ff7a18">V√ùHRA! ü•≥</h2>
      <div id="reward-val" style="font-size: 30px; margin: 15px 0; font-weight: bold;"></div>
      <div class="promo-wrap">
        <span id="promo-code">---</span>
        <button onclick="copyCode()" style="background:#ff7a18; border:none; padding:5px 10px; border-radius:5px; font-size:10px; cursor:pointer;">KOP√çROVAT</button>
      </div>
      <p style="font-size: 10px; color: #666; margin-top: 10px;">Tento k√≥d je unik√°tn√≠ a zabezpeƒçen√Ω proti √∫prav√°m.</p>
      <button class="btn" onclick="resetGame()">Zkusit znovu</button>
    </div>
  </div>
</div>

<section class="admin-verify">
    <h3>Pro Tebe: Ovƒõ≈ôovaƒç k√≥d≈Ø</h3>
    <input type="text" id="v-input" placeholder="Vlo≈æ k√≥d od klienta" style="padding:10px; border-radius:5px; border:none; margin-top:10px; width: 250px;">
    <button onclick="adminVerify()" style="padding:10px; background:#4caf50; border:none; border-radius:5px; cursor:pointer; color:white;">Ovƒõ≈ôit platnost</button>
    <div id="v-res" style="margin-top:10px; font-weight:bold;"></div>
</section>

<script>
const SALT = "SECRET_27SUN_2025"; // Kl√≠ƒç pro ≈°ifrov√°n√≠
const SYMBOLS = ["üì∑", "üé¨", "üéûÔ∏è", "‚ú®", "üíé", "üî•"];
const REWARDS = [
    { val: 10, prob: 0.50 }, // 50% ≈°ance
    { val: 20, prob: 0.30 }, // 30% ≈°ance
    { val: 50, prob: 0.15 }, // 15% ≈°ance
    { val: 100, prob: 0.05 } // 5% ≈°ance
];

let isSpinning = false;

// Inicializace v√°lc≈Ø s ikonami
function initReels() {
    [1,2,3].forEach(id => {
        const reel = document.getElementById(`reel${id}`);
        reel.innerHTML = '';
        // P≈ôid√°me 40 n√°hodn√Ωch ikon pro efekt dlouh√©ho toƒçen√≠
        for(let i=0; i<40; i++) {
            const icon = document.createElement('div');
            icon.className = 'slot-icon';
            icon.innerHTML = SYMBOLS[Math.floor(Math.random() * SYMBOLS.length)];
            reel.appendChild(icon);
        }
    });
}

function openGame() {
    document.getElementById('game-modal').style.display = 'flex';
    initReels();
    updateAttempts();
}

function closeGame() { document.getElementById('game-modal').style.display = 'none'; }

function updateAttempts() {
    const data = JSON.parse(localStorage.getItem('sun27_slots') || '{"count":0, "date":""}');
    const today = new Date().toDateString();
    let count = data.date === today ? data.count : 0;
    document.getElementById('attempts-left').innerText = `Dne≈°n√≠ pokusy: ${5 - count}/5`;
    if (count >= 5) document.getElementById('spin-btn').disabled = true;
    return count;
}

function spinSlots() {
    if (isSpinning) return;
    let count = updateAttempts();
    if (count >= 5) return;

    // Ulo≈æit pokus
    localStorage.setItem('sun27_slots', JSON.stringify({count: count + 1, date: new Date().toDateString()}));
    updateAttempts();

    isSpinning = true;
    const btn = document.getElementById('spin-btn');
    btn.disabled = true;

    // Urƒçen√≠ v√Ωsledku
    const rand = Math.random();
    let sum = 0;
    let winVal = 0;
    for(let r of REWARDS) {
        sum += r.prob;
        if(rand <= sum) { winVal = r.val; break; }
    }

    // ≈†ance na "vizu√°ln√≠" v√Ωhru (≈æe padnou 3 stejn√© symboly)
    const winVisual = Math.random() > 0.5; 
    const winIcon = SYMBOLS[Math.floor(Math.random() * SYMBOLS.length)];

    [1,2,3].forEach((id, i) => {
        const reel = document.getElementById(`reel${id}`);
        const stopIndex = 30 + i; // Zastav√≠me na konci p√°su
        const targetIcon = winVisual ? winIcon : SYMBOLS[Math.floor(Math.random() * SYMBOLS.length)];
        
        reel.children[stopIndex].innerHTML = targetIcon;
        
        // Spu≈°tƒõn√≠ animace
        setTimeout(() => {
            reel.style.transform = `translateY(-${stopIndex * 120}px)`;
        }, i * 200);
    });

    setTimeout(() => {
        isSpinning = false;
        if (winVisual) {
            showResult(winVal);
        } else {
            btn.disabled = updateAttempts() >= 5;
            btn.innerText = "Zkusit znovu";
        }
    }, 4000);
}

function showResult(val) {
    const ts = Math.floor(Date.now() / 100000); // ƒåasov√° znaƒçka
    // Vytvo≈ô√≠me podpis (hash), kter√Ω nejde snadno uhodnout
    const hash = btoa(val + SALT + ts).substring(0, 8).toUpperCase();
    const code = `27SUN-${val}-${hash}`;

    document.getElementById('game-main-screen').style.display = 'none';
    document.getElementById('game-result-screen').style.display = 'block';
    document.getElementById('reward-val').innerText = `Sleva ${val}%`;
    document.getElementById('promo-code').innerText = code;
}

function resetGame() {
    document.getElementById('game-main-screen').style.display = 'block';
    document.getElementById('game-result-screen').style.display = 'none';
    document.getElementById('spin-btn').disabled = updateAttempts() >= 5;
    [1,2,3].forEach(id => {
        const reel = document.getElementById(`reel${id}`);
        reel.style.transition = 'none';
        reel.style.transform = 'translateY(0)';
        setTimeout(() => reel.style.transition = 'transform 3s cubic-bezier(0.15, 0, 0.15, 1)', 50);
    });
}

function copyCode() {
    navigator.clipboard.writeText(document.getElementById('promo-code').innerText);
    alert("K√≥d zkop√≠rov√°n!");
}

// --- LOGIKA PRO TEBE (VERIFIKACE) ---
function adminVerify() {
    const input = document.getElementById('v-input').value.trim().toUpperCase();
    const res = document.getElementById('v-res');
    
    try {
        const parts = input.split('-');
        if (parts.length !== 3) throw "≈†patn√Ω form√°t";
        
        const val = parts[1];
        const userHash = parts[2];
        const ts = Math.floor(Date.now() / 100000);

        // Ovƒõ≈ô√≠me aktu√°ln√≠ ƒçasovou znaƒçku i tu p≈ôedchoz√≠ (aby k√≥d platil aspo≈à p√°r hodin)
        const checkHash1 = btoa(val + SALT + ts).substring(0, 8).toUpperCase();
        const checkHash2 = btoa(val + SALT + (ts-1)).substring(0, 8).toUpperCase();

        if (userHash === checkHash1 || userHash === checkHash2) {
            res.style.color = "#4caf50";
            res.innerText = `‚úÖ PLATN√ù K√ìD: Sleva ${val}%`;
        } else {
            res.style.color = "#ff4a4a";
            res.innerText = "‚ùå NEPLATN√ù NEBO UPRAVEN√ù K√ìD!";
        }
    } catch(e) {
        res.innerText = "‚ùå Chyba v k√≥du";
    }
}
</script>
</body>
</html>
